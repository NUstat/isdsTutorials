---
title: "Custom ISDS setup and functions examples"
tutorial:
  id: "isds_00"
  version: 0.1
  
output:
  learnr::tutorial:
    progressive: false
    allow_skip: true
    css: ["css/nu-theme.css"]
runtime: shiny_prerendered
description: >
  This tutorial is for educators to demonstrate how to add the various print, grade, and question functions to tutorials.
---


## ISDS grade recorder and print setup

To set up grade tracking we need to set the `isds_recorder` as the `tutorial.event_recorder`.

`{r setup}`
```{r setup, message = FALSE, warning = FALSE, echo = TRUE}
library(learnr)
library(tidyverse)
library(isdsTutorial)
library(gradethis)

gradethis_setup()
knitr::opts_chunk$set(echo = FALSE)

# need isds_recorder for grade output
options(tutorial.event_recorder = isdsTutorial::isds_recorder)
```

<br>

```{r, context = "server"}
rubric_list <- data.frame(question = c("A1", "A2", "B1", "C1", "D1", "E1", "F1", "G1"),
                          points_possible = rep(1, 8))

grade_server("grade_out", 
            rubric_list = rubric_list)
```

Next we need to set up the "rubric_list" in the `grade_server()` function. This must be in a code chunk with `context = "server"`.
The rubric_list should be a data frame consisting of two variables `question` and `points_possible`.

The name of each question is important. The name will be the name of the code chunk header with the exercise/question followed by a number starting at 1. In the following questions you will see that I named the code chunks "A", "B", "C", ... for simplicity. Note if you do NOT have the question wrapped in the `quiz()` function then the label will not have a number after. 

If you want different questions to be worth more or less points, you can specify that in the `points_possible` vector.

`{r, context = "server"}`
```{r, eval = FALSE, echo = TRUE}
rubric_list <- data.frame(question = c("A1", "A2", "B1", "C1", "D1", "E1", "F1", "G1"),
                          points_possible = rep(1, 8))

grade_server("grade_out", 
            rubric_list = rubric_list)
```

<br>

Then we can output the tutorial header. I recommend putting this before any sections so that it will always be visible no matter what part of the tutorial the student is on. The `grade_server()`, `grade_button_ui`, and `grade_output_ui` should all have the same `id`. For example, below they are all named "grade_out".

```{r isds-header, eval = FALSE, echo = TRUE}
# This chunk will output a spot for the student name, grade button, print button, and display the grade output

# student name
question_blank("Name: ___",
                            answer_fn(function(value){
                              if (length(value) >= 1 ) {
                                return(mark_as(TRUE))
                                }
                              return(mark_as(FALSE) )
                              }),
          style = "notes_question",
          correct = paste0(fontawesome::fa("check") ),
          incorrect = paste0(fontawesome::fa("xmark") ),
          allow_retry = FALSE )
# have name, grade button, and print button on same line
bootstrapPage(
     div(style="display:inline-block",
         grade_button_ui("grade_out") ),
     div(style="display:inline-block", print_ui("Print") )
)

# can have the grade output appear anywhere in your tutorial
grade_output_ui("grade_out")
```

```{r isds-header-out, echo = FALSE}
# student name
question_blank("Name: ___",
                            answer_fn(function(value){
                              if (length(value) >= 1 ) {
                                return(mark_as(TRUE))
                                }
                              return(mark_as(FALSE) )
                              }),
          style = "notes_question",
          correct = paste0(fontawesome::fa("check") ),
          incorrect = paste0(fontawesome::fa("xmark") ),
          allow_retry = FALSE )
# add grade button and print button
# the bootrapPage and div puts everything on the same line (not necessary but looks nicer)
bootstrapPage(
     div(style="display:inline-block",
         grade_button_ui("grade_out") ),
     div(style="display:inline-block", print_ui("Print") )
)

# can have the grade output appear anywhere in your tutorial
grade_output_ui("grade_out")
```

## Sample instructions for students

Each question allows 3 'free' attempts. After the third attempt a 10% deduction occurs per attempt.

Once you are finished:

-   Click the 'grade tutorial' button at the top to retrieve your score.
-   Click the 'pdf' button to save the document as a pdf, you must have the tutorial open in a browser window for this button to work.
-   Submit the completed pdf to your learning management system, like Canvas or Gradescope.


## question_blank

To insert a question with one or more blanks into a `learnr` quiz, use `question_blank()`.

You must provide the correct answers, using the `learnr` `answer()` function. The first blank should correspond to the first `answer()` and so forth. If there are multiple correct answers for a blank then this can be defined in an `answer_fn()`.

The student must have all blanks in a question correct in order for the question to be marked correct.

Note: I named the code chunk "A". So the first question is labeled "A1" and the second is "A2" in the grade output.

`{r A}`
```{r A, echo = TRUE}
quiz(caption = NULL,
    question_blank("The explanatory variable goes on the ___ axis and the response variable goes on the ___ axis",
    answer_fn(function(value){if (value %in% c("x", "X") ) {
                                return(mark_as(TRUE))}
                              return(mark_as(FALSE) )
                              }),
    answer_fn(function(value){if (value %in% c("y", "Y") ) {
                                return(mark_as(TRUE))}
                              return(mark_as(FALSE) )
                              }),
    allow_retry = TRUE
  ),
  question_blank(
     "3 + ___ = 5 <br/>
      ___ - 4 = 4 <br/>
      12 / 2 = ___",
     learnr::answer("2", correct = TRUE),
     learnr::answer("8", correct = TRUE),
     learnr::answer("6", correct = TRUE),
     allow_retry = TRUE
   )
)

```


<!-- ## question_multidrop -->

<!-- To insert a question with multiple drop-downs into a `learnr` quiz, use `question_multidrop()`. -->

<!-- `choices` should be a vector of statements that will remain stationary in the right column. -->

<!-- `answer()` should contain a vector that corresponds to the answers for `choices`. The first answer should match the first `choices` argument, and so forth. Be sure to set `correct = TRUE`. -->

<!-- Here we set `arrange = "ordered"` to have the drop-down appear in alphabetical order. Setting `box = 3` makes the drop-down box smaller and only take up 25% of the page width (can be any number between 1 and 11, inclusive). -->


<!-- ```{r} -->
<!-- ggplot(mpg, aes(cty, hwy, color = drv))+ -->
<!--   geom_point() -->
<!-- ``` -->

<!-- `{r C}` -->
<!-- ```{r C, echo = TRUE} -->
<!-- quiz(caption = NULL, -->
<!--     question_multidrop("The plot above uses the mpg dataset. Match each aesthetic with the variable that was mapped to it.", -->
<!--       choices = c("y", "x",  "color", "size"), -->
<!--            arrange = "ordered", -->
<!--            box = 3, -->
<!--            answer(c("hwy", "cty",  "drv", "not mapped"), correct = TRUE), -->
<!--            allow_retry = TRUE) -->
<!-- ) -->
<!-- ``` -->


<!-- `wordbank` is an optional parameter that allows you to add more drop-down options than actual answers. -->

<!-- `{r D}` -->
<!-- ```{r D, echo = TRUE} -->
<!-- quiz(caption = NULL, -->
<!--     question_multidrop("The plot above uses the mpg dataset. Match each aesthetic with the variable that was mapped to it.", -->
<!--       choices = c("y", "x",  "color", "size"), -->
<!--       wordbank = c("mpg", "hwy", "cty", "drv", "cyl", "not mapped"), -->
<!--            arrange = "ordered", -->
<!--            box = 3, -->
<!--            answer(c("hwy", "cty",  "drv", "not mapped"), correct = TRUE), -->
<!--            allow_retry = TRUE) -->
<!-- ) -->
<!-- ``` -->

## question_wordbank

To insert a wordbank question into a `learnr` quiz, use `question_wordbank()`.

`choices` should be a vector of statements to be matched with.

`answer()` should contain a vector that corresponds to the answers for `choices`. The first answer here "median" matches the first `choices` argument "The center of a list of numbers", and so forth. Be sure to set `correct = TRUE`.

`{r E}`
```{r E, echo = TRUE}
quiz(caption = NULL,
    question_wordbank("Match the following words with their definitions.",
            choices = c("The center of a list of numbers", 
                        "The sum of a list of numbers, divided by the number of elements in the list.",  
                        "The most common (frequent) value."),
            answer(c("median", "mean", "mode"), correct = TRUE), 
            allow_retry = TRUE )
)
```


`wordbank` is an optional parameter that allows you to add more selection options to the wordbank than possible answers. At a minimum the `wordbank` must contain the correct answers. The arguments in the `wordbank` will be displayed randomly by default.

`{r F}`
```{r F, echo = TRUE}
quiz(caption = NULL,
    question_wordbank("Match the following words with their definitions.",
            choices = c("The center of a list of numbers", 
                        "The sum of a list of numbers, divided by the number of elements in the list",  
                        "The most common (frequent) value"),
            wordbank = c("mean", "standard deviation", "median", "mode", "IQR", "range"),
            answer(c("median", "mean", "mode"), correct = TRUE), 
            allow_retry = TRUE )
)
```

If you would like the `wordbank` to appear in alphabetical order add the argument `arrange = "ordered"`. This can be useful so the `wordbank` does not accidentally randomly appear in the correct answer order if there are very few choices.

`{r G}`
```{r G, echo = TRUE}
quiz(caption = NULL,
    question_wordbank("Match the following words with their definitions.",
            choices = c("The center of a list of numbers",
                        "The sum of a list of numbers, divided by the number of elements in the list", 
                        "The most common (frequent) value"),
            wordbank = c("mean", "standard deviation", "median", "mode", "IQR", "range"),
            arrange = "ordered",
            answer(c("median", "mean", "mode"), correct = TRUE), 
            allow_retry = TRUE )
)
```


